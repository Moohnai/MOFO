# Data Preparation

We have successfully pre-trained and fine-tuned our MOFO on [Something-Something-V2](https://developer.qualcomm.com/software/ai-datasets/something-something), [Epic-Kitchens](https://epic-kitchens.github.io/2023) with this codebase.

- The pre-processing of **Something-Something-V2** can be summarized into below steps:

  1. Download the dataset from [official website](https://developer.qualcomm.com/software/ai-datasets/something-something).

  2. Create optical flow and motion maps with `scripts/data/motion_map_creator.py`

  3. Process motion maps to generate automatic bounding boxes with `scripts/data/bounding_box_creator_SSV.py`. It will create a json file that the path is needed for pretraining step.

  4. Preprocess the dataset by changing the video extension from `webm` to `.mp4` with the **original** height of **240px**. We provide the pre-processing [script](scripts/data/data_clean.py) here.

  5. Generate annotations needed for dataloader ("<path_to_video> <video_class>" in annotations). The annotation usually includes `train.csv`, `val.csv` and `test.csv` ( here `test.csv` is the same as `val.csv`). The format of `*.csv` file is like:

     ```
     dataset_root/video_1.mp4  label_1
     dataset_root/video_2.mp4  label_2
     dataset_root/video_3.mp4  label_3
     ...
     dataset_root/video_N.mp4  label_N
     ```

- The same steps are needed for **Epic-Kitchens** dataset. The only difference is that the bounding boxes are generated by `scripts/data/bounding_box_creator_Epic_Kitchens.py` and the preprocessing script by `scripts/data/Epic-kitchen/data_clean_Epic_Kitchens.py`.